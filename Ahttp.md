### HTTPS通信过程大致如下：

1. 客户端向服务器发送请求，请求建立SSL连接。

2. 服务器响应请求，并返回一个数字证书。这个证书包含了公钥及由权威机构签名的身份信息。

3. 客户端验证服务器的数字证书。如果证书有效，则生成一个随机值（会话密钥），并用服务器的公钥加密后发送给服务器。

   服务器接收到客户端发来的加密信息后，用自己的私钥进行解密得到（会话密钥）。

   至此，客户端和服务器双方都拥有了同样的会话密钥。他们将使用这个会话密钥对接下来要发送或接收的所有信息进行加解密。

#### HTTPS是否能被攻击，答案是可以。虽然HTTPS提供了非常高级别的安全性，但还是存在一些潜在风险：

- 中间人攻击：攻击者插入客户端与服务端之间，并截获、篡改通信内容。
- 伪造证书：如果CA（Certificate Authority）被破坏或者不可信任，则可能出现伪造证书情况。

总结起来说，HTTPS主要有三大优点：

- 数据完整性：内容在传输过程中不会被更改
- 数据隐私：内容在传输过程中是经过加密处理
- 身份验证：确认网站身份真实有效

##### HTTPS协议在建立连接时仍然遵循TCP协议中的“三次握手”和“四次挥手”的规则。

* 三次握手（TCP连接建立）：

1. 客户端发送一个SYN包给服务器请求建立连接，

2. 服务器回复一个SYN-ACK包应答，

3. 最后客户端再回复一个ACK包。

   这样双方都确认了自己和对方的发送与接收能力，完成了TCP连接。

* 四次挥手（TCP连接断开）：

1. 当数据传送完毕后，任何一方都可发起断开TCP连接的请求。假设客户端发起请求，则先发送FIN包给服务器表明已无数据需要传输；

2. 服务器收到后返回ACK应答，

3. 服务器将所有未处理完的数据处理完毕后也发送FIN给客户端；

4. 最后客户端再返回ACK应答

   至此，双方都确认了对方已经没有数据需要传输和处理了，完成了TCP连接的断开。

   

HTTPS协议本质上是HTTP协议在SSL/TLS基础上增加安全保护层，并不改变HTTP协议使用TCP进行通信的事实。所以HTTPS也会进行三次握手和四次挥手。

### Https

1. 客户端 -----------【请求访问】带上 随机数？+客户端支持的哈希加密算法--------> 服务端（公钥、私钥）

2. 客户端 <---------【给公钥+证书】带上 随机数2？+将要用到的哈希加密算法----------  服务端

3. 客户端用**公钥**加密（通信密钥）--------------------------------------------------->  服务端 用**私钥**进行解密得到（通信密钥）

   传递数据：客户端<---------------------【通信密钥】------------------------------------ 服务端

   ​				  客户端用【通信密钥】拿到内容

tips:

a. 3是非对称加密；正常传递数据是对称加密

b. https 连接中，无法伪造请求

c. 客户端本地可以查到证书是否合法，不需要发请求，避免 伪装成服务端发假证书

d. 请求时和返回的证书不一致，客户端可通过 refer 判断证书是否是请求的那个

e. 对称加密效率高于非对称加密，所以尽量用对称加密

#### tips:

1. SYN：这是"Synchronize Sequence Numbers"的缩写，用于在TCP/IP连接中同步序列号。当一个新的TCP连接被创建时，发送方会发送一个带有SYN标志位的数据包给接收方来请求建立连接。
2. ACK：这是"Acknowledgement"的缩写，表示确认。当一方收到对方发过来的数据后，会返回一个带有ACK标志位的数据包以确认“我已经收到你之前发送过来的数据了”。
3. FIN：这是"Finish" 的缩写, 用于结束 TCP 连接。当一端完成了它需要发送所有数据后, 它将发送带有 FIN 标志位设定为 1 的 TCP 数据包给另一端, 表示 "我已经完成了我需要传送给你所有信息".

### http1.0

### http2

### http3